<div class="mt-10 mb-20 flex flex-col items-center">
    <%- include("headers/pageHeader.ejs", {pageTitle: "Carrinho"}) %>
    <form class="flex flex-col gap-26">
        <div class="flex flex-row w-full justify-between mt-10 px-32">
            <!---BEGIN: lista de livros-->
            <div class="w-2/3">
                <ul class="divide-y divide-light-brown">
                    <% books.forEach(function(book) { %>
                        <li class="flex flex-row gap-4 py-4 items-center justify-between">
                            <img src="<%= book.coverPath %>" alt="Capa do livro <%= book.name %>" class="w-16 h-20 object-cover rounded">
                            <h2 class="font-semibold text-dark-gray text-[14px] w-48 truncate"><%= book.name %></h2>
                            <div class="flex items-center gap-2 ml-4 w-28 justify-center">
                                <button class="px-2 py-1 text-xs bg-gray-200 rounded hover:bg-gray-2" title="Diminuir quantidade">-</button>
                                <input type="text" value="<%= book.quantity || 1 %>" class="w-8 text-center border rounded text-[12px] bg-white" readonly>
                                <button class="px-2 py-1 text-xs bg-gray-200 rounded hover:bg-gray-3" title="Aumentar quantidade">+</button>
                            </div>
                            <p class="font-semibold text-brown text-[14px] ml-4 w-24 text-center">R$ <%= book.price.toFixed(2).replace('.', ',') %></p>
                            <button class="justify-center items-center delete-btn text-red-700 rounded hover:bg-red-200 ml-4 w-10 flex" title="Remover do carrinho">
                                <span class="material-symbols-outlined text-base">delete</span>
                            </button>
                        </li>
                    <% }); %>
                </ul>
            </div>
            <!---BEGIN: dados para finalizar pedido-->
            <div class="w-1/3 ml-10 flex flex-col gap-6">
                <!---BEGIN: cupons-->
                <div class="flex flex-col gap-4 p-4 border border-light-brown rounded-md">
                    <h1 class="font-bold text-[18px] text-brown">Cupons</h1>
                    <p>Tem cupons? Você pode utilizá-los para obter desconto:</p>
                    <div class="flex flex-col gap-2">
                        <h2 class="font-semibold text-gray-dark">Selecione um cupom:</h2>
                        <div class="flex gap-2">
                            <select name="coupon" class="border border-gray-dark text-gray-dark rounded px-2 py-1 w-full text-[12px]">
                                <option value="">Nenhum cupom</option>
                                <% coupons.forEach(function(coupon) { %>
                                    <option value="<%= coupon.code %>"><%= coupon.name %> (<%= coupon.discount %>%)</option>
                                <% }); %>
                            </select>
                            <button type="button" class="bg-brown text-white px-4 py-1 rounded hover:bg-dark-brown text-[12px]">Aplicar</button>
                        </div>
                    </div>
                </div>
                <!---BEGIN: valores-->
                <div class="flex flex-col gap-4 p-4 border border-light-brown rounded-md">
                    <h1 class="font-bold text-[18px] text-brown">Valores</h1>
                    <div class="flex justify-between">
                        <h2 class="text-gray-dark [12px]">Subtotal de itens:</h2>
                        <p class="font-semibold">R$ 34,90</p>
                    </div>
                    <div class="flex justify-between">
                        <h2 class="text-gray-dark [12px]">Frete:</h2>
                        <p class="font-semibold">R$ 10,10</p>
                    </div>
                    <div class="flex justify-between">
                        <h2 class="text-gray-dark [12px]">Descontos de cupons:</h2>
                        <p class="text-light-green">- R$ 15,00</p>
                    </div>
                    <div class="flex justify-between border-t border-gray pt-2 text-dark-brown">
                        <h2 class="font-semibold text-[16px]">Total:</h2>
                        <p class="font-semibold text-[16px]">R$ 30,00</p>
                    </div>
                </div>
                <!---BEGIN: detalhes da compra-->
                <div class="flex flex-col gap-4 p-4 border border-light-brown rounded-md">
                    <h1 class="font-bold text-[18px] text-brown">Detalhes da Compra</h1>
                    <div class="flex flex-col gap-4">
                        <div>
                            <h2 class="font-semibold text-gray-dark [12px] mb-2">Endereço de Entrega:</h2>
                            <select name="userAddress" class="border border-gray-dark text-gray-dark rounded px-2 py-1 w-full text-[12px]">
                                <option value="1">Endereço preferido (Rod. das Palmeiras ...)</option>
                            </select>
                        </div>
                        <div>
                            <h2 class="font-semibold text-gray-dark [12px] mb-2">Método de Pagamento:</h2>
                            <select name="paymentMethod" class="border border-gray-dark text-gray-dark rounded px-2 py-1 w-full text-[12px]">
                                <option value="credit_card">Mastercard N 1234.1234.1234.24</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end">
                    <button type="submit" class="font-semibold text-sm bg-light-green text-white rounded hover:bg-dark-green w-[150px] h-10 flex items-center justify-center">
                        Finalizar Pedido
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>
<script src="/scripts/handleSubmit.mjs"></script>
<script src="/scripts/deleteSubmit.js"></script>
